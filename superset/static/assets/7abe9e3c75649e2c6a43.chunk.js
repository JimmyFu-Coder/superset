"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[9563],{54070:(e,t,a)=>{a.d(t,{w:()=>n}),a(67294);var l=a(58593),r=a(83379),o=a(61988),s=a(70917);const n=({user:e,date:t})=>{const a=(0,s.tZ)("span",{className:"no-wrap"},t);if(e){const t=(0,r.Z)(e),n=(0,o.t)("Modified by: %s",t);return(0,s.tZ)(l.u,{title:n,placement:"bottom"},a)}return a}},29848:(e,t,a)=>{a.d(t,{Z:()=>c}),a(67294);var l=a(51995),r=a(58593),o=a(70707),s=a(70917);const n=l.iK.span`
  white-space: nowrap;
  min-width: 100px;
  svg,
  i {
    margin-right: 8px;

    &:hover {
      path {
        fill: ${({theme:e})=>e.colors.primary.base};
      }
    }
  }
`,i=l.iK.span`
  color: ${({theme:e})=>e.colors.grayscale.base};
`;function c({actions:e}){return(0,s.tZ)(n,{className:"actions"},e.map(((e,t)=>{const a=o.Z[e.icon];return e.tooltip?(0,s.tZ)(r.u,{id:`${e.label}-tooltip`,title:e.tooltip,placement:e.placement,key:t},(0,s.tZ)(i,{role:"button",tabIndex:0,className:"action-button",onClick:e.onClick},(0,s.tZ)(a,null))):(0,s.tZ)(i,{role:"button",tabIndex:0,className:"action-button",onClick:e.onClick,key:t},(0,s.tZ)(a,null))})))}},94222:(e,t,a)=>{a.d(t,{Z:()=>u});var l=a(51995),r=a(61988),o=(a(67294),a(58593)),s=a(70707),n=a(90335),i=a(70917);function c(e,t,a){switch(e){case n.Z.Working:return a.colors.primary.base;case n.Z.Error:return a.colors.error.base;case n.Z.Success:return t?a.colors.success.base:a.colors.alert.base;case n.Z.Noop:return a.colors.success.base;case n.Z.Grace:return a.colors.alert.base;default:return a.colors.grayscale.base}}function u({state:e,isReportEnabled:t=!1}){const a=(0,l.Fg)(),u={icon:s.Z.Check,label:"",status:""};switch(e){case n.Z.Success:u.icon=t?s.Z.Check:s.Z.AlertSolidSmall,u.label=t?(0,r.t)("Report sent"):(0,r.t)("Alert triggered, notification sent"),u.status=n.Z.Success;break;case n.Z.Working:u.icon=s.Z.Running,u.label=t?(0,r.t)("Report sending"):(0,r.t)("Alert running"),u.status=n.Z.Working;break;case n.Z.Error:u.icon=s.Z.XSmall,u.label=t?(0,r.t)("Report failed"):(0,r.t)("Alert failed"),u.status=n.Z.Error;break;case n.Z.Noop:u.icon=s.Z.Check,u.label=(0,r.t)("Nothing triggered"),u.status=n.Z.Noop;break;case n.Z.Grace:u.icon=s.Z.AlertSolidSmall,u.label=(0,r.t)("Alert Triggered, In Grace Period"),u.status=n.Z.Grace;break;default:u.icon=s.Z.Check,u.label=(0,r.t)("Nothing triggered"),u.status=n.Z.Noop}const d=u.icon;return(0,i.tZ)(o.u,{title:u.label,placement:"bottomLeft"},(0,i.tZ)(d,{iconColor:c(u.status,t,a)}))}},90335:(e,t,a)=>{var l,r;a.d(t,{Z:()=>l,u:()=>r}),function(e){e.Success="Success",e.Working="Working",e.Error="Error",e.Noop="Not triggered",e.Grace="On Grace"}(l||(l={})),function(e){e.Email="Email",e.Slack="Slack"}(r||(r={}))},32635:(e,t,a)=>{a.r(t),a.d(t,{default:()=>K});var l=a(67294),r=a(16550),o=a(75049),s=a(61988),n=a(22102),i=a(51995),c=a(31069),u=a(30381),d=a.n(u),p=a(29848),m=a(34581),g=a(58593),Z=a(93139),b=a(86074),h=a(12441),k=a(27600),f=a(14114),y=a(94222),w=a(70917),S=a(70707),v=a(90335);const C=e=>w.iv`
  color: ${e.colors.grayscale.light1};
  margin-right: ${2*e.gridUnit}px;
`;function E({type:e}){const t={icon:null,label:""};switch(e){case v.u.Email:t.icon=(0,w.tZ)(S.Z.Email,{css:C}),t.label=v.u.Email;break;case v.u.Slack:t.icon=(0,w.tZ)(S.Z.Slack,{css:C}),t.label=v.u.Slack;break;default:t.icon=null,t.label=""}return t.icon?(0,w.tZ)(g.u,{title:t.label,placement:"bottom"},t.icon):null}var $=a(19259),x=a(17198);d().updateLocale("en",{calendar:{lastDay:"[Yesterday at] LTS",sameDay:"[Today at] LTS",nextDay:"[Tomorrow at] LTS",lastWeek:"[last] dddd [at] LTS",nextWeek:"dddd [at] LTS",sameElse:"L"}});const _=i.iK.span`
  color: ${({theme:e})=>e.colors.grayscale.base};
`,A=(0,i.iK)(S.Z.Refresh)`
  color: ${({theme:e})=>e.colors.primary.base};
  width: auto;
  height: ${({theme:e})=>5*e.gridUnit}px;
  position: relative;
  top: ${({theme:e})=>e.gridUnit}px;
  left: ${({theme:e})=>e.gridUnit}px;
  cursor: pointer;
`,N=({updatedAt:e,update:t})=>{const[a,r]=(0,l.useState)(d()(e));return(0,l.useEffect)((()=>{r((()=>d()(e)));const t=setInterval((()=>{r((()=>d()(e)))}),6e4);return()=>clearInterval(t)}),[e]),(0,w.tZ)(_,null,(0,s.t)("Last Updated %s",a.isValid()?a.calendar():"--"),t&&(0,w.tZ)(A,{onClick:t}))};var T=a(34858),L=a(40768),R=a(22318),z=a(20095),D=a(54070),H=a(12);const W=(0,o.I)(),G={[v.Z.Success]:(0,s.t)("Success"),[v.Z.Working]:(0,s.t)("Working"),[v.Z.Error]:(0,s.t)("Error"),[v.Z.Noop]:(0,s.t)("Not triggered"),[v.Z.Grace]:(0,s.t)("On Grace")},B=(0,n.Z)({requestType:"rison",method:"DELETE",endpoint:"/api/v1/report/"}),I=i.iK.div`
  width: 100%;
  padding: 0 ${({theme:e})=>4*e.gridUnit}px
    ${({theme:e})=>3*e.gridUnit}px;
  background-color: ${({theme:e})=>e.colors.grayscale.light5};
`,M=i.iK.div`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  > *:first-child {
    margin-right: ${({theme:e})=>e.gridUnit}px;
  }
`,U=W.get("alertsreports.header.icon"),K=(0,f.ZP)((function({addDangerToast:e,isReportEnabled:t=!1,user:a,addSuccessToast:o}){const n=t?(0,s.t)("report"):(0,s.t)("alert"),i=t?(0,s.t)("reports"):(0,s.t)("alerts"),u=t?"Reports":"Alerts",f=(0,l.useMemo)((()=>[{id:"type",operator:Z.p.equals,value:t?"Report":"Alert"}]),[t]),{state:{loading:S,resourceCount:C,resourceCollection:_,bulkSelectEnabled:A,lastFetched:W},hasPerm:K,fetchData:F,setResourceCollection:O,refreshData:P,toggleBulkSelect:q}=(0,T.Yi)("report",(0,s.t)("reports"),e,!0,void 0,f),{updateResource:V}=(0,T.LE)("report",(0,s.t)("reports"),e),[Y,j]=(0,l.useState)(!1),[J,X]=(0,l.useState)(null),[Q,ee]=(0,l.useState)(null);function te(e){X(e),j(!0)}const ae=K("can_write"),le=K("can_write"),re=K("can_write");(0,l.useEffect)((()=>{A&&le&&q()}),[t]);const oe=[{id:"name",desc:!0}],se=(0,l.useCallback)(((e,t)=>{if(null!=e&&e.id){const a=e.id,l=[..._];O(l.map((a=>(null==a?void 0:a.id)===e.id?{...a,active:t}:a))),V(a,{active:t},!1,!1).then().catch((()=>O(l)))}}),[_,O,V]),ne=(0,l.useMemo)((()=>[{Cell:({row:{original:{last_state:e}}})=>(0,w.tZ)(y.Z,{state:e,isReportEnabled:t}),accessor:"last_state",size:"xs",disableSortBy:!0},{Cell:({row:{original:{last_eval_dttm:e}}})=>e?d().utc(e).local().format(k.v2):"",accessor:"last_eval_dttm",Header:(0,s.t)("Last run"),size:"lg"},{accessor:"name",Header:(0,s.t)("Name"),size:"xl"},{Header:(0,s.t)("Schedule"),accessor:"crontab_humanized",size:"xl",Cell:({row:{original:{crontab_humanized:e="",timezone:t}}})=>(0,w.tZ)(g.u,{title:`${e} (${t})`,placement:"topLeft"},(0,w.tZ)("span",null,`${e} (${t})`))},{Cell:({row:{original:{recipients:e}}})=>e.map((e=>(0,w.tZ)(E,{key:e.id,type:e.type}))),accessor:"recipients",Header:(0,s.t)("Notification method"),disableSortBy:!0,size:"xl"},{Cell:({row:{original:{owners:e=[]}}})=>(0,w.tZ)(m.Z,{users:e}),Header:(0,s.t)("Owners"),id:"owners",disableSortBy:!0,size:"xl"},{Cell:({row:{original:{changed_on_delta_humanized:e,changed_by:t}}})=>(0,w.tZ)(D.w,{date:e,user:t}),Header:(0,s.t)("Last modified"),accessor:"changed_on_delta_humanized",size:"xl"},{Cell:({row:{original:e}})=>{const t=e.owners.map((e=>e.id)).includes(a.userId)||(0,R.i5)(a);return(0,w.tZ)(h.r,{disabled:!t,checked:e.active,onClick:t=>se(e,t),size:"small"})},Header:(0,s.t)("Active"),accessor:"active",id:"active",size:"xl"},{Cell:({row:{original:e}})=>{const t=(0,r.k6)(),l=e.owners.map((e=>e.id)).includes(a.userId)||(0,R.i5)(a),o=[ae?{label:"execution-log-action",tooltip:(0,s.t)("Execution log"),placement:"bottom",icon:"Note",onClick:()=>t.push(`/${e.type.toLowerCase()}/${e.id}/log`)}:null,ae?{label:l?"edit-action":"preview-action",tooltip:l?(0,s.t)("Edit"):(0,s.t)("View"),placement:"bottom",icon:l?"Edit":"Binoculars",onClick:()=>te(e)}:null,l&&le?{label:"delete-action",tooltip:(0,s.t)("Delete"),placement:"bottom",icon:"Trash",onClick:()=>ee(e)}:null].filter((e=>null!==e));return(0,w.tZ)(p.Z,{actions:o})},Header:(0,s.t)("Actions"),id:"actions",hidden:!ae&&!le,disableSortBy:!0,size:"xl"},{accessor:H.J.changed_by,hidden:!0}]),[le,ae,t,se]),ie=[];re&&ie.push({name:(0,w.tZ)(l.Fragment,null,(0,w.tZ)("i",{className:"fa fa-plus"})," ",n),buttonStyle:"primary",onClick:()=>{te(null)}}),le&&ie.push({name:(0,s.t)("Bulk select"),onClick:q,buttonStyle:"secondary","data-test":"bulk-select-toggle"});const ce={title:(0,s.t)("No %s yet",i),image:"filter-results.svg",buttonAction:()=>te(null),buttonText:re?(0,w.tZ)(l.Fragment,null,(0,w.tZ)("i",{className:"fa fa-plus"})," ",n," "):null},ue=(0,l.useMemo)((()=>[{Header:(0,s.t)("Name"),key:"search",id:"name",input:"search",operator:Z.p.contains},{Header:(0,s.t)("Owner"),key:"owner",id:"owners",input:"select",operator:Z.p.relationManyMany,unfilteredLabel:(0,s.t)("All"),fetchSelects:(0,L.tm)("report","owners",(0,L.v$)((e=>(0,s.t)("An error occurred while fetching owners values: %s",e))),a),paginate:!0},{Header:(0,s.t)("Status"),key:"status",id:"last_state",input:"select",operator:Z.p.equals,unfilteredLabel:"Any",selects:[{label:G[v.Z.Success],value:v.Z.Success},{label:G[v.Z.Working],value:v.Z.Working},{label:G[v.Z.Error],value:v.Z.Error},{label:G[v.Z.Noop],value:v.Z.Noop},{label:G[v.Z.Grace],value:v.Z.Grace}]},{Header:(0,s.t)("Modified by"),key:"changed_by",id:"changed_by",input:"select",operator:Z.p.relationOneMany,unfilteredLabel:(0,s.t)("All"),fetchSelects:(0,L.tm)("report","changed_by",(0,L.v$)((e=>(0,s.t)("An error occurred while fetching dataset datasource values: %s",e))),a),paginate:!0}]),[]),de=U?(0,w.tZ)(M,null,(0,w.tZ)("div",null,(0,s.t)("Alerts & reports")),(0,w.tZ)(U,null)):(0,s.t)("Alerts & reports");return(0,w.tZ)(l.Fragment,null,(0,w.tZ)(b.Z,{activeChild:u,name:de,tabs:[{name:"Alerts",label:(0,s.t)("Alerts"),url:"/alert/list/",usesRouter:!0,"data-test":"alert-list"},{name:"Reports",label:(0,s.t)("Reports"),url:"/report/list/",usesRouter:!0,"data-test":"report-list"}],buttons:ie},(0,w.tZ)(I,null,(0,w.tZ)(N,{updatedAt:W,update:()=>P()}))),(0,w.tZ)(z.ZP,{alert:J,addDangerToast:e,layer:J,onHide:()=>{j(!1),X(null),P()},show:Y,isReport:t,key:(null==J?void 0:J.id)||`${(new Date).getTime()}`}),Q&&(0,w.tZ)(x.Z,{description:(0,s.t)("This action will permanently delete %s.",Q.name),onConfirm:()=>{Q&&(({id:t,name:a})=>{c.Z.delete({endpoint:`/api/v1/report/${t}`}).then((()=>{P(),ee(null),o((0,s.t)("Deleted: %s",a))}),(0,L.v$)((t=>e((0,s.t)("There was an issue deleting %s: %s",a,t)))))})(Q)},onHide:()=>ee(null),open:!0,title:(0,s.t)("Delete %s?",n)}),(0,w.tZ)($.Z,{title:(0,s.t)("Please confirm"),description:(0,s.t)("Are you sure you want to delete the selected %s?",i),onConfirm:async t=>{try{const{message:e}=await B(t.map((({id:e})=>e)));P(),o(e)}catch(t){(0,L.v$)((t=>e((0,s.t)("There was an issue deleting the selected %s: %s",i,t))))(t)}}},(t=>{const a=le?[{key:"delete",name:(0,s.t)("Delete"),onSelect:t,type:"danger"}]:[];return(0,w.tZ)(Z.Z,{className:"alerts-list-view",columns:ne,count:C,data:_,emptyState:ce,fetchData:F,filters:ue,initialSort:oe,loading:S,bulkActions:a,bulkSelectEnabled:A,disableBulkSelect:q,refreshData:P,addDangerToast:e,addSuccessToast:o,pageSize:25})})))}))},83379:(e,t,a)=>{function l(e){return e?`${e.first_name} ${e.last_name}`:""}a.d(t,{Z:()=>l})}}]);
//# sourceMappingURL=7abe9e3c75649e2c6a43.chunk.js.map